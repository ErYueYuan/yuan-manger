<template>
    <div class="bg7">
        <div class="fun-top-panel bg-my  ">
            <span class="mess-back " @click="goBack()"><div class="cont-wh"></div></span>
            <span class="title c7 f4 dblock2 t-center ">个人信息</span>
        </div>

        <div class="main-container mar1  clearfix">
            <div class="my-n-txtbox s-bg posi2">
                <div class="add-btn c7 t-center f1 c-p" style="border-radius: 6px 0 0 15px;" @click="addRecord()">新增跟进记录</div>
                <div class="top-one  clearfix" >
                    <div class=" pad3 right-box posi2 c7 " >
                        <h3 class=" f3 c-p"><span>{{nikeName}}</span>
                        </h3>
                        <div class="f2 c7 per-info mar3 ">
                            <b class="one"></b>来源：
                            <span v-if="getSource == 1">系统分配</span>
                            <span v-if="getSource == 2">主动取数</span>
                            <span v-if="getSource == 3">自建客户</span>
                            <span v-if="getSource == 4">成交客户</span>
                        </div>
                        <!-- <div class="f2 c7 per-info  ">
                            <b class="two"></b>客户号：CC0157941027
                        </div> -->
                        <div class="f2 c7 per-info  ">
                            <b class="three"></b>客户等级：
                            <span class="stars-box2" v-if="customerStar == 1"><i></i></span>
                            <span class="stars-box2" v-if="customerStar == 2"><i></i><i></i></span>
                            <span class="stars-box2" v-if="customerStar == 3"><i></i><i></i><i></i></span>
                            <span class="stars-box2" v-if="customerStar == 4"><i></i><i></i><i></i><i></i></span>
                            <span class="stars-box2" v-if="customerStar == 5"><i></i><i></i><i></i><i></i><i></i></span>
                        </div>
                    </div>
                    <div class="img-box  posi2">
                        <img v-if="!!sex && sex == 1" src="../../assets/img/szxx/me.png" />
                        <img v-if="!!sex && sex == 0" src="../../assets/img/szxx/dau.png" />
                    </div>
                </div>
            </div>

            <div class=" mar3-5 clearfix">
                <section class="b-radius1 pad1-3 bg7 clearfix">
                    <div id="proNav" class="swiper-container border-b1">
                        <div class="swiper-wrapper f-flex" style="overflow-x: scroll;">
                            <!-- 推荐 -->
                            <div class="swiper-slide " style="display: inline-block; width: 80px;">
                                <div class="fun-info-p5 pro " :class="tabTitle == 1 ? 'active' : ''" @click="tabClick('1')">
                                    <label class="f3-1"><b>基本信息</b></label>
                                </div>
                            </div>
                            <div class="swiper-slide "  style="display: inline-block; width: 80px;">
                                <div class="fun-info-p5 pro"  :class="tabTitle == 2 ? 'active' : ''" @click="tabClick('2')">
                                    <label class="f3-1"><b>订单</b></label>
                                </div>
                            </div>
                            <div class="swiper-slide " style="display: inline-block; width: 80px;">
                                <div class="fun-info-p5 pro" :class="tabTitle == 3 ? 'active' : ''" @click="tabClick('3')">
                                    <label class="f3-1"><b>轨迹</b></label>
                                </div>
                            </div>
                            <div class="swiper-slide " style="display: inline-block; width: 80px;">
                                <div class="fun-info-p5 pro" :class="tabTitle == 4 ? 'active' : ''" @click="tabClick('4')" >
                                    <label class="f3-1"><b>跟进</b></label>
                                </div>
                            </div>
                            <div class="swiper-slide " style="display: inline-block; width: 80px;">
                                <div class="fun-info-p5 pro" :class="tabTitle == 5 ? 'active' : ''" @click="tabClick('5')">
                                    <label class="f3-1"><b>历史方案</b></label>
                                </div>
                            </div>
                             <div class="swiper-slide " style="display: inline-block; width: 80px;">
                                <div class="fun-info-p5 pro" :class="tabTitle == 6 ? 'active' : ''" @click="tabClick('6')">
                                    <label class="f3-1"><b>已购产品</b></label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 基本信息 -->
                    <div v-show="tabTitle == '1'">
                        <div class="bg7 mar3-2 pad1-3 b-sh1 fun-info-b1">
                                <h3 class="tit f3 c6 bold">客户画像</h3>
                                <div class="floor1 posi2">
                                    <div class="avator"><img src="../../assets/img/szxx/me.png" /></div>
                                    <span>女</span>
                                    <span>38岁</span>
                                    <span>三口之家</span>
                                    <span>产品咨询</span>
                                </div>
                                <div class="floor2">
                                    <span>高预算</span>
                                    <span>高预算</span>
                                    <span>高预算</span>
                                    <span class="edit c-p" @click="editLabel()"><i></i>编辑</span>
                                </div>
                                <h3 class="tit f3 c6 mar3-2 bold">互动情况</h3>
                                <ul class="ul01">
                                    <li>消息沟通：9月13日添加为好友，已产生25条信息互动</li>
                                    <li>最近轨迹：2020-08-08  10:11 查看产品链接 </li>
                                    <li>回访预约时间：2020-08-08  10:11 </li>
                                </ul>
                                    <h3 class="tit f3 c6 mar3-2 bold">历史方案<span class="f-right f1 c4">查看更多</span></h3>
                                    <section class="blk-cont2020  ">
                                    <ul class="cont-blk  icon-wrap ">
                                        <li class="li-p5  posi2 clearfix">
                                        <div class="product2020 f-left posi2">
                                            <img class="lazy-p" src="https://www.baoxian.com/product_file/ERiskPic/100901007.jpg" alt="pic">
                                            <span class="state"><i class="t1"></i>网销</span>
                                        </div>
                                        <div class="info-blk  ">
                                            <h3 class=" mess f3 c44 ">信泰如意尊终身寿险</h3>
                                            <p class="f2 mess">锁定利率，高额航空意外，定向传承</p>
                                            <p class="f2 mar2  mess">编码: JHS2020071251083</p>
                                            <p class="f2 mess">首期保费：<span class="c8">5000￥起</span></p>
                                        </div>
                                        </li>
                                    </ul>
                                    </section>
                        </div>
                        
                        <div class="ek-com-tit bold">详细信息</div>
                        <section class="member-box bg7  b-sh5">
                            <div id="pMember" class="swiper-container">
                                <div class="swiper-wrapper">
                                    <div class="swiper-slide dblock"    v-for="(item, index) in familyList" :key="index"  :class="relation == index ? 'active' : ''"   @click="currentRelation(item, index)">
                                        <img v-show="item.relationFlag == '01' && item.sex == 1" src="../../assets/img/szxx/me.png"/><!-- 本人 -->
                                        <img v-show="item.relationFlag == '01' && item.sex == 0" src="../../assets/img/szxx/dau.png"/>

                                        <img v-show="item.relationFlag == '02' && item.sex == 1" src="../../assets/img/szxx/dau.png"/><!-- 配偶 -->
                                        <img v-show="item.relationFlag == '02' && item.sex == 0" src="../../assets/img/szxx/me.png"/>

                                        <img v-show="item.relationFlag == '06' || item.relationFlag == '16'" src="../../assets/img/szxx/mama.png"/><!-- 长辈 -->
                                        <img v-show="item.relationFlag == '05' || item.relationFlag == '15'" src="../../assets/img/szxx/papa.png"/>
                                        <img v-show="item.relationFlag == '08' || item.relationFlag == '14'" src="../../assets/img/szxx/gma.png"/>
                                        <img v-show="item.relationFlag == '07' || item.relationFlag == '13'" src="../../assets/img/szxx/gpa.png"/>

                                        <img v-show="item.relationFlag == '03'" src="../../assets/img/szxx/gson.png"/><!-- 子女 -->
                                        <img v-show="item.relationFlag == '04'" src="../../assets/img/szxx/gdau.png"/>

                                        <img v-show="item.relationFlag == '09' || item.relationFlag == '11'" src="../../assets/img/szxx/ggson.png"/><!-- 孙辈 -->
                                        <img v-show="item.relationFlag == '10' || item.relationFlag == '12'" src="../../assets/img/szxx/ggdau.png"/>
                                        
                                        <img v-show="item.sex == 2" src="../../assets/img/szxx/other.png"/><!-- 性别未知 -->
                                        <span>{{item.relationName}}</span>

                                        <!-- <div class="bar" title="当前"></div> --><!-- 小下标 -->
                                    </div>

                                    <div class="swiper-slide dblock">
                                        <img src="../../assets/img/szxx/add.png"/>
                                        <span title="添加"><span style="opacity: 0;">添加</span>&nbsp;</span>
                                        <div class="bar" title="当前"></div>
                                    </div>
                                </div>
                            </div>
                        </section>

                        <!-- 基本信息 -->
                        <section class="mar3-6 bg7  b-sh1">
                            <section class="pad1">
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1" style="font-weight: bolder !important">{{relationFlag == '01' ? '本人信息' : '家人信息'}}</dt>
                                    <dd class="t-right f3 c8 flex-end" @click="editCustomerDetail(clientId)">
                                        <img src="../../assets/img/szxx/edit2.png" alt="" class="editimg">编辑
                                    </dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">姓名</dt>
                                    <dd class="t-right f3 c5 ">{{customerDetail.cname}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">性别</dt>
                                    <dd class="t-right f3 c5 " v-show="!!customerDetail.sex">{{customerDetail.sex == '0' ? '女' : '男'}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">手机号码</dt>
                                    <dd class="t-right f3 c5 ">{{customerDetail.mobile}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">出生日期</dt>
                                    <dd class="t-right f3 c5 ">{{customerDetail.birthday }}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">年龄</dt>
                                    <dd class="t-right f3 c5 ">{{customerDetail.age}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">国籍</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.nationality}}</dd>
                                </dl>
                                <dl class="per-box bg7">
                                    <dt class="c6 f3-1">婚姻</dt>
                                    <dd class="t-right f3 c5" v-show="customerDetail.marriage == 1">已婚</dd>
                                    <dd class="t-right f3 c5" v-show="customerDetail.marriage == 2">未婚</dd>
                                    <dd class="t-right f3 c5" v-show="customerDetail.marriage == 3">离异</dd>
                                    <dd class="t-right f3 c5" v-show="customerDetail.marriage == 4">再婚</dd>
                                    <dd class="t-right f3 c5" v-show="customerDetail.marriage == 5">丧偶</dd>
                                </dl>
                            </section>
                        </section>

                        <!-- 证件类型 -->
                        <section class="mar3-6 bg7  b-sh1">
                            <section class="pad1">
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">证件类型</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.cerTypeName}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">证件有效期</dt>
                                    <dd class="t-right f3 c5" v-show="customerDetail.cerValidDateType == '1'">{{customerDetail.cerValidDate}}</dd>
                                    <dd class="t-right f3 c5" v-show="customerDetail.cerValidDateType == '0'">长期有效</dd>
                                </dl>
                                <dl class="per-box bg7">
                                    <dt class="c6 f3-1">证件号码</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.cerCode}}</dd>
                                </dl>
                            </section>
                        </section>

                        <!-- 行业 -->
                        <section class="mar3-6 bg7  b-sh1" v-show="otherInfo">
                            <section class="pad1">
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">行业</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.occupname}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">职业</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.occupxtionname}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">电子邮箱</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.email}}</dd>
                                </dl>
                                <dl class="per-box bg7 border-b1">
                                    <dt class="c6 f3-1">手机号码</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.mobile}}</dd>
                                </dl>
                                <dl class="per-box bg7">
                                    <dt class="c6 f3-1">税收居民</dt>
                                    <dd class="t-right f3 c5"></dd>
                                </dl>
                            </section>
                        </section>

                        <!-- 常住城市，有个选择框 -->
                        <section class="mar3-6 bg7  b-sh1" v-show="otherInfo">
                            <section class="pad1">
                                <dl class="per-box pb2 bg7 border-b1">
                                    <dt class="c6 f3-1">常住城市</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.provinceName}} - {{customerDetail.cityName}} - {{customerDetail.countyName}}</dd>
                                </dl>
                                <dl class="per-box line2 bg7 border-b1">
                                    <dt class="c6 f3-1">详细地址</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.address}}</dd>
                                </dl>
                                <dl class="per-box bg7">
                                    <dt class="c6 f3-1">邮政编码</dt>
                                    <dd class="t-right f3 c5">{{customerDetail.postalcode}}</dd>
                                </dl>
                            </section>
                        </section>
                        <br>
                    </div>

                    <!-- 订单 -->
                    <div v-show="tabTitle == '2'">
                        <section class="mar3-2">
                            <div class="b-sh1  pad5-5 bg7  mar7-3">
                                <section class="mar20 bg7 " >
                                    <div class="order-box-2020 " >
                                        <h3 class="  order-tit posi2 f3 c3">
                                            <div class="col-9 pad0 tit mess">华夏华夏红（钻石版）年金保险 </div>
                                            <span class="status f1 ts3">投保录入中</span>
                                            <span class="status f1 ts4" >客户录入单</span> <!--双录状态-->
                                            <div class="col-12 f2 c4 t-left time">创建时间：2020-09-17 14:25:13.0</div>
                                        </h3>

                                        <div class="order-box  clearfix posi2">
                                            <section class="f2 pad0" >
                                                <p class="order-info"><span class="p-tit">订单号</span><span class="c4">2020000000203349</span></p>
                                                <p><span class="p-tit">投保人</span><span class="c4">啦啦</span></p>
                                                <p><span class="p-tit">保费</span><span class="c4">35000</span> </p>
                                                <p class="order-memo clearfix border-t2"><span class="p-tit f-left">备注</span><span class="c222 mess5 memo"></span></p>
                                            </section>
                                        </div>
                                    </div>
                                    <div class="t-right  posi2 bg7">
                                        <button class="f-left btn sxt-btn-3 showMoreBtn" title="展开剩余菜单" ></button>
                                        <div class="sl-other-b ">
                                            <b class="sl-trangle"></b>
                                            <span class="border-b1" >订单轨迹</span>
                                            <span >写备忘</span>
                                        </div>
                                        <button class=" ek-btn-3 f1" >照会</button>
                                        <button class=" ek-btn-3 f1" >取消订单</button>
                                        <button class=" ek-btn-4  f1 " >继续录入</button>
                                        <button class=" ek-btn-3 wi1 f1">刷新</button>
                                    </div>
                                </section>
                            </div>
                            <div class="b-sh1  pad5-5 bg7  mar7-3">
                                <section class="mar20 bg7 " >
                                    <div class="order-box-2020 " >
                                        <h3 class="  order-tit posi2 f3 c3">
                                            <div class="col-9 pad0 tit mess">华夏华夏红（钻石版）年金保险 </div>
                                            <span class="status f1 ts3">投保录入中</span>
                                            <span class="status f1 ts4" >客户录入单</span> <!--双录状态-->
                                            <div class="col-12 f2 c4 t-left time">创建时间：2020-09-17 14:25:13.0</div>
                                        </h3>

                                        <div class="order-box  clearfix posi2">
                                        <section class="f2 pad0" >
                                            <p class="order-info"><span class="p-tit">订单号</span><span class="c4">2020000000203349</span></p>
                                            <p><span class="p-tit">投保人</span><span class="c4">啦啦</span></p>
                                            <p><span class="p-tit">保费</span><span class="c4">35000</span> </p>
                                            <p class="order-memo clearfix border-t2"><span class="p-tit f-left">备注</span><span class="c222 mess5 memo"></span></p>
                                        </section>
                                        </div>
                                    </div>
                                    <div class="t-right  posi2 bg7">
                                        <button class="f-left btn sxt-btn-3 showMoreBtn" title="展开剩余菜单" ></button>
                                        <div class="sl-other-b ">
                                            <b class="sl-trangle"></b>
                                            <span class="border-b1" >订单轨迹</span>
                                            <span >写备忘</span>
                                        </div>
                                        <button class=" ek-btn-3 f1" >照会</button>
                                        <button class=" ek-btn-3 f1" >取消订单</button>
                                        <button class=" ek-btn-4  f1 " >继续录入</button>
                                        <button class=" ek-btn-3 wi1 f1">刷新</button>
                                    </div>
                                </section>
                            </div>
                            <div class="b-sh1  pad5-5 bg7  mar7-3">
                                <section class="mar20 bg7 " >
                                    <div class="order-box-2020 " >
                                        <h3 class="  order-tit posi2 f3 c3">
                                            <div class="col-9 pad0 tit mess">华夏华夏红（钻石版）年金保险 </div>
                                            <span class="status f1 ts3">投保录入中</span>
                                            <span class="status f1 ts4" >客户录入单</span> <!--双录状态-->
                                            <div class="col-12 f2 c4 t-left time">创建时间：2020-09-17 14:25:13.0</div>
                                        </h3>

                                        <div class="order-box  clearfix posi2">
                                        <section class="f2 pad0" >
                                            <p class="order-info"><span class="p-tit">订单号</span><span class="c4">2020000000203349</span></p>
                                            <p><span class="p-tit">投保人</span><span class="c4">啦啦</span></p>
                                            <p><span class="p-tit">保费</span><span class="c4">35000</span> </p>
                                            <p class="order-memo clearfix border-t2"><span class="p-tit f-left">备注</span><span class="c222 mess5 memo"></span></p>
                                        </section>
                                        </div>
                                    </div>
                                    <div class="t-right  posi2 bg7">
                                        <button class="f-left btn sxt-btn-3 showMoreBtn" title="展开剩余菜单" ></button>
                                            <div class="sl-other-b ">
                                            <b class="sl-trangle"></b>
                                            <span class="border-b1" >订单轨迹</span>
                                            <span >写备忘</span>
                                        </div>
                                        <button class=" ek-btn-3 f1" >照会</button>
                                        <button class=" ek-btn-3 f1" >取消订单</button>
                                        <button class=" ek-btn-4  f1 " >继续录入</button>
                                        <button class=" ek-btn-3 wi1 f1">刷新</button>
                                    </div>
                                </section>
                            </div>
                        </section>
                    </div>

                    <!-- 轨迹 -->
                    <div v-show="tabTitle == '3'">
                        <section class="mar3-2">
                            <div class="b-sh1  pad1-3 bg7  mar7-3">
                                <div class="blk-cont-box posi2  ">
                                    <div class="img-box2 posi2">
                                        <img src="../../assets/img/index/bar_bg.png">
                                    </div>
                                    <div class="right-box rb1 posi2 c-p">
                                        <h3 class="f2 c6 mar7-2">访问产品“国寿财茁壮成长学生保险白银版计划书”</h3>
                                        <div class="f1 c4 t-right">
                                        <span class="f-left">大约停留1分30秒</span>2030-12-21 09:15:00
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="b-sh1  pad1-3 bg7  mar7-3">
                                <div class="blk-cont-box posi2  ">
                                    <div class="img-box2 posi2">
                                        <img src="../../assets/img/index/bar_bg.png">
                                        </div>
                                        <div class="right-box rb1 posi2 c-p">
                                        <h3 class="f2 c6 mar7-2">访问产品“国寿财茁壮成长学生保险白银版计划书”</h3>
                                        <div class="f1 c4 t-right">
                                            <span class="f-left">大约停留1分30秒</span>2030-12-21 09:15:00
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="b-sh1  pad1-3 bg7  mar7-3">
                                <div class="blk-cont-box posi2  ">
                                    <div class="img-box2 posi2">
                                        <img src="../../assets/img/index/bar_bg.png">
                                        </div>
                                        <div class="right-box rb1 posi2 c-p">
                                        <h3 class="f2 c6 mar7-2">访问产品“国寿财茁壮成长学生保险白银版计划书”</h3>
                                        <div class="f1 c4 t-right">
                                            <span class="f-left">大约停留1分30秒</span>2030-12-21 09:15:00
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>

                    <!-- 跟进 -->
                    <div v-show="tabTitle == '4'">
                        <section class="mar3-2">
                            <div class="b-sh1  pad1-3 bg7  mar7-3">
                                <div class="stu-tracks3 posi2 mar5">
                                    <ul class="border-b1" style="padding: 10px 0;">
                                        <li class="border-b1" v-for="(item, index) in funFollowUpDTOList" :key="index">
                                            <div class="top f2 c8">{{item.followTime}}<span class="f-right ek-btn-7 f1 c-p" @click="editRecord()">编辑跟进记录</span></div>
                                            <div class=" blk  posi2 ">
                                                <div class="f2 cont "><span class="tit">本次跟进内容</span><span class="txt">{{item.followContent}}</span></div>
                                                <div class="f2 cont "><span class="tit">客户需求评估</span><span class="txt">{{item.tagName}}</span></div>
                                                <div class="f2 cont "><span class="tit">跟进结果</span><span class="txt">{{item.followUpResult}}</span></div>
                                                <div class="f2 cont "><span class="tit">回访时间</span><span class="txt">{{item.callbackTime}}</span></div>
                                                <div class="f2 cont "><span class="tit">回访内容</span><span class="txt">{{item.callbackContent}}</span></div>
                                            </div>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </section>
                    </div>

                    <!-- 历史方案 -->
                    <div v-show="tabTitle == '5'">
                        <section class="mar3-2">
                            <div class="b-sh1   bg7  mar7-3">
                                <section class="blk-cont2020  ">
                                    <ul class="cont-blk  icon-wrap ">
                                        <li class="li-p6  posi2 clearfix">
                                        <div class="product2020 f-left posi2">
                                            <img class="lazy-p" src="https://www.baoxian.com/product_file/ERiskPic/100901007.jpg" alt="pic">
                                        </div>
                                        <div class="info-blk  ">
                                            <h3 class=" mess f3 c44 ">华夏福两全保险家庭保障方</h3>
                                            <p class="f2 c4  mar444 mess">家庭保障方案</p>
                                            <div class="t-left f2 c4 mar2">
                                                编码: JHS2020071251083
                                            </div>
                                            <div class="t-left c4 f2 ">
                                                首期保费:<span class="c9">2192.00元</span>
                                            </div>
                                        </div>
                                        </li>
                                    </ul>
                                    <div class="t-right mar6-2 pad6-1 border-t">
                                        <button class=" ek-btn-4 min-w f1 " >编辑</button>
                                        <button class=" ek-btn-3 min-w f1">删除</button>
                                    </div>
                                </section>
                            </div>

                            <div class="b-sh1   bg7  mar7-3">
                                <section class="blk-cont2020  ">
                                    <ul class="cont-blk  icon-wrap ">
                                        <li class="li-p6  posi2 clearfix">
                                        <div class="product2020 f-left posi2">
                                            <img class="lazy-p" src="https://www.baoxian.com/product_file/ERiskPic/100901007.jpg" alt="pic">
                                        </div>
                                        <div class="info-blk  ">
                                            <h3 class=" mess f3 c44 ">华夏福两全保险家庭保障方</h3>
                                            <p class="f2 c4  mar444 mess">家庭保障方案</p>
                                            <div class="t-left f2 c4 mar2">
                                                编码: JHS2020071251083
                                            </div>
                                            <div class="t-left c4 f2 ">
                                                首期保费:<span class="c9">2192.00元</span>
                                            </div>
                                        </div>
                                        </li>
                                    </ul>
                                    <div class="t-right mar6-2 pad6-1 border-t">
                                        <button class=" ek-btn-4 min-w f1 " >编辑</button>
                                        <button class=" ek-btn-3 min-w f1">删除</button>
                                    </div>
                                </section>
                            </div>

                            <div class="b-sh1   bg7  mar7-3">
                                <section class="blk-cont2020  ">
                                    <ul class="cont-blk  icon-wrap ">
                                        <li class="li-p6  posi2 clearfix">
                                        <div class="product2020 f-left posi2">
                                            <img class="lazy-p" src="https://www.baoxian.com/product_file/ERiskPic/100901007.jpg" alt="pic">
                                        </div>
                                        <div class="info-blk  ">
                                            <h3 class=" mess f3 c44 ">华夏福两全保险家庭保障方</h3>
                                            <p class="f2 c4  mar444 mess">家庭保障方案</p>
                                            <div class="t-left f2 c4 mar2">
                                                编码: JHS2020071251083
                                            </div>
                                            <div class="t-left c4 f2 ">
                                                首期保费:<span class="c9">2192.00元</span>
                                            </div>
                                        </div>
                                        </li>
                                    </ul>
                                    <div class="t-right mar6-2 pad6-1 border-t">
                                        <button class=" ek-btn-4 min-w f1 " >编辑</button>
                                        <button class=" ek-btn-3 min-w f1">删除</button>
                                    </div>
                                </section>
                            </div>
                        </section>
                    </div>

                    <!-- 已购产品 -->
                    <div v-show="tabTitle == '6'">
                        <section class="row mar0 mar3">
                            <div class="col-4 pad0" v-for="(item, index) in funProductTagDTOList" :key="index"  :class="productTag == index ? 'active' : ''"  @click="chooseProductTag(item)"><span class="hx-bt3 bt2 f3">{{item.tagName}}</span></div>
                        </section>
                        <section class="mar3-2">
                            <div class="b-sh1  pad1-3 bg7  mar7-3" v-for="(item,index) in funProductDTOList" :key="index">
                                <section class="mar20 bg7">
                                    <div class="order-box-2020 " >
                                        <h3 class="  order-tit posi2 f3 c3">
                                            <div class="col-9 pad0 tit mess">{{item.riskName}}</div>
                                            <span class="status f1 ts3" style="display:none;">投保录入中</span>
                                            <span class="status f1 ts4" style="display:none;">客户录入单</span> <!--双录状态-->
                                            <span class="status f1 ts4" >{{item.state}}</span>
                                            <div class="col-12 f2 c4 t-left time">生效日期：{{item.effectiveDate}}</div>
                                        </h3>
                                        <div class="order-box  clearfix posi2">
                                            <section class="f2 pad0" >
                                                <p class="order-info"><span class="p-tit">保单号</span><span class="c4">{{item.contNo}}</span></p>
                                                <p><span class="p-tit">险种</span><span class="c4">{{item.riskType}}</span></p>
                                                <p><span class="p-tit">投保人</span><span class="c4">{{item.holderName}}</span></p>
                                                <p><span class="p-tit">被保人</span><span class="c4">{{item.insureName}}</span></p>
                                                <p><span class="p-tit">保费</span><span class="c4">{{item.prem}}</span> </p>
                                                <p class="order-memo clearfix border-t2"><span class="p-tit f-left">备注</span><span class="c222 mess5 memo">{{item.remark}}</span></p>
                                            </section>
                                        </div>
                                    </div>
                                    <div class="t-right  pad6-1 ">
                                        <button class=" ek-btn-4 min-w f1 " >写备忘</button>
                                    </div>
                                </section>
                            </div>
                        </section>
                    </div>


                </section>
            </div>
        </div>

        <div class="in-nav-bot posi1 " >
            <div class=" c-p "><b class="one"></b><p class="f1 t-center c6">客户沟通</p></div>
            <div class=" c-p pad0">
                <b class="two"></b><p class="f1 t-center c6">电话</p>
            </div>
            <div class=" c-p pad0">
                <b class="three"></b><p class="f1 t-center c6">制作方案</p>
            </div>
            <div class="bbtn t-right c-p">
                <span class="hx-bt3 bt1 f3 ">投保</span>
            </div>
        </div>
    </div>
</template>
<script>
    import Vue from 'vue'
    import { mapGetters } from 'vuex'
    import * as tool from '@/common/Tool'
    import { api_sell } from '@/api/index'
    import DataSource from '@/common/DataSource'
    import { Popup, Picker } from 'vant'
    // import Rules from './Rules'
    // import Works from './Works'
    // import Visitor from './Visitor'
    // import Performance from './Performance'

    Vue.use(Popup)
    Vue.use(Picker)

    export default {
        name: "CustomerDetail",
        data () {
            return {
                clientId: this.$route.params.q,//客户id
                clientNewId: this.$route.params.r,
                nikeName: "",
                sex: "",//1男，0女，2未知
                getSource: "",
                customerStar: "",
                cerCode: "",
                customerDetail: [],
                familyList: [],//家庭成员列表
                relation: 0,//家庭成员列表初始化展示项
                relationFlag: "01",
                otherInfo: true,
                tabTitle: '1',
                funProductTagDTOList: [],//已购产品标签列表
                funProductDTOList: [],//已购产品列表
                productTag: 'B',//已购产品标签初始化展示项,B:寿险产品E:互助产品:F:理财产品
                funFollowUpDTOList: [],//跟进列表
                
            }
        },
        computed: {
            ...mapGetters(['user']),
        },
        components: {
            // 'rules': Rules,
            // 'works': Works,
            // 'visitor': Visitor,
            // 'performance': Performance
        },
        created () {
            this.queryBasicIntroduction();//基本介绍
            this.getCustomerDetail();//客户详情
            this.getFamilyList();//家庭成员列表
            this.getProductTag();//已购产品标签查询
            this.getCustomerProduct();//已购产品查询
            this.queryFollowUpList();//跟进列表查询
        },
        methods: {
            queryBasicIntroduction () {
                const _data = {
                    saasId: tool.app.saasId,
                    clientNewidId: "fb27daf7aee911ea967f6c92bf603fec",//客户id
                }
                api_sell.queryBasicIntroduction(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.nikeName = data.nikeName;
                        this.sex = data.sex;
                        this.getSource = data.getSource;
                        this.customerStar = data.customerStar;
                        this.cerCode = data.cerCode;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            tabClick (type) {
                this.tabTitle = type;
            },

            currentRelation (item, index) {
                console.log('item--',item)
                this.relation = index;
                this.clientId = item.clientId;
                this.relationFlag = item.relationFlag;
                if (item.relationFlag == '01') {
                    this.otherInfo = true;
                } else {
                    this.otherInfo = false;
                }
                this.getCustomerDetail(item.clientId);
            },

            getFamilyList () {
                const _data = {
                    "agentCode": "310201480",
                    // "clientId": this.clientId,
                    "clientId": "db01e84366f811e9967f6c92bf603fec",
                    "saasId": tool.app.saasId,
                    "offset": 0,
                    "limit": 10
                }
                api_sell.getFamilyList(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.familyList = data.familyList;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            getCustomerDetail (clientId) {
                const _data = {
                    saasId: tool.app.saasId,
                    clientId: !!clientId ? clientId : this.clientId
                }
                api_sell.getCustomerDetail(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.customerDetail = data.customerDetail;
                        this.customerDetail.cname = data.customerDetail.cname;
                        this.customerDetail.sex = data.customerDetail.sex;
                        this.customerDetail.birthday = data.customerDetail.birthday;
                        this.customerDetail.age = data.customerDetail.age;
                        this.customerDetail.nationality = data.customerDetail.nationality;//国籍
                        this.customerDetailmarriage = data.customerDetail.marriage;//1-已婚;2-未婚;3-离异;4-再婚;5-丧偶
                        this.customerDetail.cerType = data.customerDetail.cerType;
                        this.customerDetail.cerCode = data.customerDetail.cerCode;
                        this.customerDetail.cerTypeName = data.customerDetail.cerTypeName;
                        this.customerDetail.cerValidDateType = data.customerDetail.cerValidDateType;//长短期有效
                        this.customerDetail.occup = data.customerDetail.occup;
                        this.customerDetail.occupname = data.customerDetail.occupname;
                        this.customerDetail.occupxtion = data.customerDetail.occupxtion;
                        this.customerDetail.occupxtionname = data.customerDetail.occupxtionname;
                        this.customerDetail.email = data.customerDetail.email;
                        this.customerDetail.mobile = data.customerDetail.mobile;
                        this.customerDetail.province = data.customerDetail.province;
                        this.customerDetail.city = data.customerDetail.city;
                        this.customerDetail.county = data.customerDetail.county;
                        this.customerDetail.provinceName = data.customerDetail.provinceName;
                        this.customerDetail.cityName = data.customerDetail.cityName;
                        this.customerDetail.countyName = data.customerDetail.countyName;
                        this.customerDetail.address = data.customerDetail.address;
                        this.customerDetail.postalcode = data.customerDetail.postalcode;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            queryFollowUpList () {
                const _data = {
                    // agentUserId: "",//代理人ID
                    // saasId: tool.app.saasId,
                    // clientNewidId: this.clientNewId,//客户id
                    agentUserId: "0003660579e611e9a021246e965b5bf8",
                    saasId: tool.app.saasId,
                    clientNewidId: "fb27daf7aee911ea967f6c92bf603fec",
                }
                api_sell.queryFollowUpList(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        console.log('777',data)
                        this.funFollowUpDTOList = data.funFollowUpDTOList;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            getProductTag () {
                const _data = {
                    saasId: tool.app.saasId,
                }
                api_sell.getProductTag(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.funProductTagDTOList = data.funProductTagDTOList;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            chooseProductTag (item) {
                this.productTag = item.tagValue;
                this.getCustomerProduct(item.tagValue);
            },

            getCustomerProduct (value) {
                const _data = {
                    // name: this.nikeName,
                    // saasId: tool.app.saasId,
                    // idNo: this.cerCode,
                    // riskType: !!value ? value : this.productTag
                    
                    name: "汝振鑫",
                    saasId: tool.app.saasId,
                    idNo: "230506199407230019",
                    riskType: "1"
                }
                api_sell.getCustomerProduct(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.funProductDTOList = data.funProductDTOList;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            editLabel () {
                this.$router.push({ path: '/editLabel/' + this.clientId});
            },

            editCustomerDetail (clientId) {
                this.$router.push({ path: '/editCustomerDetail/' + this.clientId + '/' + this.clientNewId});
            },
            
            addRecord () {
                this.$router.push({ path: '/followRecord'});
            },
            
            editRecord () {
                this.$router.push({ path: '/editFollowRecord'});
            },

            goBack () {
                this.$router.push({ path: '/sellList/' + "1"});
            },
            
            
        }
    }
</script>
<style scoped>
  
</style>