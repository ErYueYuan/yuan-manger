<template>
    <div class="bg3">
        <div class="fun-top-panel bg7" @click="goBack()">
            <span class="mess-back "><div class="cont"></div></span>
            <span class="title c3 f3 dblock2 t-center ">添加家庭成员</span>
        </div>
        <div class="main-container mar3-7 no-bot clearfix" style="padding-bottom: 220px;">
            <section class="b-radius3  bg7 mar3-2">
                <dl id="relation" class="per-box52   border-b" @click="showPopup()">
                    <dt class="c6 f3-1">关系</dt>
                    <dd class="t-right c6 f3 c2 arrow"><input type="text" class="ca-input t-right" placeholder="请选择" disabled :value="familyList.relationName"></dd>
                </dl>
                <dl class="per-box52   border-b">
                    <dt class="c6 f3-1">姓名</dt>
                    <dd class="t-right f3 c6 clearfix"><input type="text" class="ca-input w2 t-right" placeholder="请输入" v-model="familyList.name"><span class="f-right insure-icon icon-addr mar1-2" title=""></span></dd>
                </dl>
                <div class="error-alert mr" title="错误提示">姓名不能包含数字</div>
                <dl class="per-box52   border-b">
                    <dt class="c6 f3-1">手机号码</dt>
                    <dd class="t-right c6 f3 c2"><input type="text" class="ca-input t-right" placeholder="请输入" v-model="familyList.phone"></dd>
                </dl>
                <dl class="per-box52   border-b">
                    <dt class="c6 f3-1">性别</dt>
                    <dd class="t-right f3 ">
                    <div class="f-right pad4 t-left">
                        <label class="reg-sel-btn posi2">
                            <input type="radio" name="a">
                            <b class="btn">男</b>
                        </label>
                    </div>
                    <div class="f-right pad4 t-left">
                        <label class="reg-sel-btn posi2">
                            <input type="radio" name="a">
                            <b class="btn">女</b>
                        </label>
                    </div>
                    </dd>
                </dl>
                <dl class="per-box52   border-b">
                    <dt class="c6 f3-1">出生日期</dt>
                    <dd class="t-right f3 c6 arrow">
                        <select name="" id="" style="color: #999;">
                            <option value="">请选择</option>
                        </select>
                    </dd>
                </dl>
                <dl class="per-box52   border-b">
                    <dt class="c6 f3-1">年龄</dt>
                    <dd class="t-right c6 f3 c2"><input type="text" class="ca-input t-right" placeholder="请输入" disabled></dd>
                </dl>
                <dl id="country" class="per-box52   border-b" @click="showCountryPopup()">
                    <dt class="c6 f3-1">国籍</dt>
                    <dd class="t-right c6 f3 c2 arrow"><input type="text" class="ca-input t-right" placeholder="请选择" disabled :value="familyList.countryName"></dd>
                </dl>
                <dl id="marry" class="per-box52   " @click="showMarryPopup()">
                    <dt class="c6 f3-1">婚姻</dt>
                    <dd class="t-right c6 f3 c2 arrow"><input type="text" class="ca-input t-right" placeholder="请选择" disabled :value="familyList.marryName"></dd>
                </dl>
                <dl class="per-box52   border-b  border-t">
                    <dt class="c6 f3-1">证件有效期</dt>
                    <dd class="t-right f3 c6 arrow">
                        <select name="" id="" style="color: #999;">
                            <option value="">请选择</option>
                        </select>
                    </dd>
                </dl>
                <dl id="certype" class="per-box52   border-b" @click="showCertypePopup()">
                    <dt class="c6 f3-1">证件类型</dt>
                    <dd class="t-right c6 f3 c2 arrow"><input type="text" class="ca-input t-right" placeholder="请选择" disabled :value="familyList.cerTypeName"></dd>
                </dl>
                <dl class="per-box52   border-b">
                    <dt class="c6 f3-1">证件号码</dt>
                    <dd class="t-right f3 c6 clearfix"><input type="text" class="ca-input w2 t-right" placeholder="请输入"><span class="f-right insure-icon icon-addr mar1-2" title="通讯录"></span></dd>
                </dl>
            </section>
        </div>
        <div class="pad5-9 posi1 b1 bg7 border-t">
            <div class="reg-bt t-center">
                <button type="button" class="b-right" style="width: 100%;border-radius: 50px;" @click="save()">保存</button>
            </div>
        </div>

        <!-- 弹出层 -->
        <van-popup
            v-model="show"
            position="bottom"
            :style="{height: '50%'}"
            get-container = "relation"
            safe-area-inset-bottom
            >
            <div v-for="(item, index) in relationList" :key="index" @click="chooseRelation(item)" class="el-loading-text">{{item.name}}</div>
        </van-popup>
        <!-- end -->
        <van-popup
            v-model="showCountry"
            position="bottom"
            :style="{height: '30%'}"
            get-container = "country"
            safe-area-inset-bottom
            >
            <div v-for="(item, index) in countryList" :key="index" @click="chooseCountry(item)" class="el-loading-text">{{item.name}}</div>
        </van-popup>
        <van-popup
            v-model="showMarry"
            position="bottom"
            :style="{height: '30%'}"
            get-container = "marry"
            safe-area-inset-bottom
            >
            <div v-for="(item, index) in marriageList" :key="index" @click="chooseMarry(item)" class="el-loading-text">{{item.name}}</div>
        </van-popup>
        <van-popup
            v-model="showCertype"
            position="bottom"
            :style="{height: '50%'}"
            get-container = "certype"
            safe-area-inset-bottom
            >
            <div v-for="(item, index) in idtypeList" :key="index" @click="chooseCertype(item)" class="el-loading-text">{{item.name}}</div>
        </van-popup>
    </div>
</template>
<script>
    import Vue from 'vue'
    import { mapGetters } from 'vuex'
    import * as tool from '@/common/Tool'
    import { api_sell } from '@/api/index'
    import DataSource from '@/common/DataSource'
    import { Popup } from 'vant'
    // import Rules from './Rules'
    // import Works from './Works'
    // import Visitor from './Visitor'
    // import Performance from './Performance'

    Vue.use(Popup)

    export default {
        name: "AddFamily",
        data () {
            return {
                familyList: [],
                relationList: [],
                countryList: [],
                marriageList: [],
                idtypeList: [],
                show: false,
                showCountry: false,
                showMarry: false,
                showCertype: false,
            }
        },
        computed: {
            ...mapGetters(['user']),
        },
        components: {
            // 'rules': Rules,
            // 'works': Works,
            // 'visitor': Visitor,
            // 'performance': Performance
        },
        created () {
            this.queryRelation();//关系
            this.queryCountry();//国籍
            this.queryMarriage();//婚姻
            this.queryIdtype();//证件类型
        },
        methods: {
            queryRelation () {
                const _data = {type: 'cus_relation/' + tool.app.platformCode + '/' + tool.app.saasId}
                api_sell.sysDict(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.relationList = data.params.dicts;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            queryCountry () {
                const _data = {type: 'cbs_country/' + tool.app.platformCode + '/' + tool.app.saasId}
                api_sell.sysDict(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.countryList = data.params.dicts;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            queryMarriage () {
                const _data = {type: 'cbs_marriage/' + tool.app.platformCode + '/' + tool.app.saasId}
                api_sell.sysDict(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.marriageList = data.params.dicts;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            queryIdtype () {
                const _data = {type: 'cbs_idtype/' + tool.app.platformCode + '/' + tool.app.saasId}
                api_sell.sysDict(_data).then(data => {
                    if (data.status == tool.rtCode.status) {
                        this.idtypeList = data.params.dicts;
                    } else {
                        tool.toastMessage(data.message, 'error');
                    }
                })
            },

            showPopup () {
                this.show = true;
            },
            showCountryPopup () {
                this.showCountry = true;
            },
            showMarryPopup () {
                this.showMarry = true;
            },
            showCertypePopup () {
                this.showCertype = true;
            },

            chooseRelation (item) {
                this.familyList.relationCode = item.value;
                this.familyList.relationName = item.name;
                this.show = false;
            },
            chooseCountry (item) {
                this.familyList.nationality = item.value;
                this.familyList.countryName = item.name;
                this.showCountry = false;
            },
            chooseMarry (item) {
                this.familyList.marriage = item.value;
                this.familyList.marryName = item.name;
                this.showMarry = false;
            },
            chooseCertype (item) {
                this.familyList.cerType = item.value;
                this.familyList.cerTypeName = item.name;
                this.showCertype = false;
            },

            goBack () {
                this.$router.go(-1);
            },

        }
    }
</script>
<style scoped>
  
</style>