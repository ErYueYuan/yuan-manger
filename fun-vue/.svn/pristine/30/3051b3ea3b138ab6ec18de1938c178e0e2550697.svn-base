<template>
  <div class="bg3">
    <top-panel :topPanel="topPanel"></top-panel>
    <div class="main-container mar1 no-bot clearfix ">
      <div class="new-nav-box mar3">
        <ul>
          <li class="setting setting1  bg7 f3-1 c6" @click="$router.push({name:'amendpassword'})">修改密码</li>
          <li class="setting settin10  bg7 f3-1 c6">关于我们</li>
        </ul>
        <div class="out-login  f3-1 c6 bg7 t-center" v-if="isWeiXin" @click="unbound">解绑微信</div>
        <div class="out-login  f3-1 c6 bg7 t-center" v-if="!isWeiXin" @click="outLogin">退出登录</div>
      </div>
    </div>
  </div>
</template>

<script>
  import { TopPanel } from '@/components/index'
  import { mapGetters } from 'vuex'
  import { api_user } from '@/api/index'
  import * as tool from '@/common/Tool'
  import DataSource from '@/common/DataSource'

  export default {
    computed: {
      ...mapGetters(['user']),
    },
    data() {
      return {
        topPanel: {
          back: true,
          titles: "设置",
          home: true
        },
        isWeiXin: tool.globalData.isWeiXin
      }
    },
    components: {
      'top-panel': TopPanel
    },
    mounted() {

    },
    beforeCreate: function() {
      document.getElementsByTagName("body")[0].className = "bg3";
    },
    methods: {
      goBack() {
        this.$router.go(-1)
      },
      unbound() {
        api_user.unbind4WX({
          saasId: tool.app.saasId,
          userId: this.user.userid,
          openid: this.user.userInfo.openid,
          agentType: this.user.userInfo.agentType,
          channelFlag: this.user.userInfo.channelFlag,
        })
          .then(res => {
            if (res.status == tool.rtCode.status) {
              tool.toastMessage('解绑成功')
              DataSource.clear()
              this.$router.push({ name: 'login' })
            }
          })
      },
      outLogin(){
        DataSource.clear()
        this.$router.push({ name: 'login' })
      }
    }
  }
</script>

<style scoped>


 /* .new-nav-box li.setting1:before {
    top: 14px;
    width: 16px;
    height: 22px;
  }*/

  .out-login {
    height: 52px;
    line-height: 52px;
    margin-bottom: 0px;
    padding: 0 15px 0 42px;
  }
</style>
