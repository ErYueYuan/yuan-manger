<template>
  <div>
    <top-panel :topPanel="topPanel" v-if="!sourceChannel.isWeiXin"></top-panel>
    <div class="main-container clearfix" :class="!sourceChannel.isWeiXin?'mar1':''">
      <div class="pad5-1 clearfix">
        <swiper :bannerList="bannerList"></swiper>
      </div>
      <div class="pad6">
        <van-tabs>
          <van-tab title="精品课程"></van-tab>
          <van-tab title="热门文章"></van-tab>
        </van-tabs>
      </div>
    </div>
  </div>
</template>

<script>
  import Vue from 'vue'
  import { Tab, Tabs } from 'vant'
  import { mapGetters } from "vuex"
  import { Swiper, TopPanel } from "@/components/index"
  import { api_system, api_article } from "@/api/index"
  import * as tool from "@/common/Tool"

  Vue.use(Tab)
  Vue.use(Tabs)

  export default {
    name: "CoursesList",
    data () {
      return {
        sourceChannel: tool.globalData,
        topPanel: {
          back: true,
          titles: "学习课堂",
        },
        bannerList: [],
        oneId: ''
      }
    },
    components: {
      'swiper': Swiper,
      'top-panel': TopPanel,
    },
    created () {
      this.getBannerData()
      this.getArticleOneData()
    },
    methods: {
      getBannerData() {
        var _data = {
          limit: tool.pagination.pagesize, // 页面长度
          offset: tool.pagination.pageoffset, // 页面偏移
          type: "0", //广告类型:0-懒掌柜首页广告栏,1-产品广告栏,2-资讯广告栏,3-培训广告位,4-理赔广告栏,5-DDSS广告栏，6-e管家首页广告位，7-财富精选广告位
          comcode: "1000000",
          platformId: 'f2ce8561055a40d5a5e7dcdffde1e8bc' // tool.app.platformId, //区分项目
        };
        api_system.advertismentList4Front(_data).then((res) => {
          if (res.status == tool.rtCode.status) {
            this.bannerList = res.advertismentList;
            for (let it of this.bannerList) {
              it.image = it.posterImage
              it.url = it.pageUrl
            }
          }
        });
      },
      getArticleOneData() {
        let _data = {
          platformId: '5e00309b49ce4011a924a7ceb6740af8', // tool.app.platformId,
          saasId: tool.app.saasId,
          classLevel: "0", //0 查询所有一级分类
          className: "财富精选",
        };
        api_article.articleClassList(_data).then((res) => {
          if (res.status == tool.rtCode.status) {
            if (res.articleClassList.length > 0) {
              this.oneId = res.articleClassList[0].id;
              this.getArticleTwoData();
            }
          }
        });
      },
      getArticleTwoData() {
        let _data = {
          platformId: '5e00309b49ce4011a924a7ceb6740af8', //tool.app.platformId,
          saasId: tool.app.saasId,
          classId: this.oneId,
          classLevel: "1", //1 查询所有二级级分类
        };
        api_article.articleClassList(_data).then((res) => {
          if (res.status == tool.rtCode.status) {
            if (res.articleClassList.length > 0) {
              this.articleClassList = res.articleClassList;
              this.getInfoList(this.articleClassList[0].id, 0);
            }
          }
        });
      },
    }
  }
</script>

<style scoped>

</style>
