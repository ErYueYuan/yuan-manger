<template>
  <div>
    <div class="index-top4">
      <h3 class="ek-com-tit2 c6 f3">昨日业绩</h3>
      <div class="  message-box5 mar7-1">
        <ul class="b-radius3 bg4 ">
          <li class=" pad6-1 f2  ">
            <span class="sp1 f3 c5">{{yesterdayDate.sameDayTarget || 0}}</span>
            <span class="f1 c4">新增标保</span>
            <span class=" f1-1 c4 ">(万元)</span>
          </li>
          <li class="b-radius3 pad6-1 f2 mar7-2 bg4">
            <span class="sp1 f3 c5">{{yesterdayDate.sameDayPrem || 0}}</span>
            <span class="f1 c4">新增保费</span>
            <span class=" f1-1 c4 ">(万元)</span>
          </li>
          <li class="b-radius3 pad6-1 f2 mar7-2 bg4">
            <span class="sp1 f3 c5">{{yesterdayDate.policy || 0}}</span>
            <span class="f1 c4">新增保单</span>
            <span class=" f1-1 c4 ">(份)</span>
          </li>
          <li class="b-radius3 pad6-1 f2 mar7-2 bg4">
            <span class="sp1 f3 c5">{{yesterdayDate.extension || 0}}</span>
            <span class="f1 c4">预计佣金</span>
            <span class=" f1-1 c4 ">(元)</span>
          </li>
        </ul>
      </div>
    </div>
    <div class="index-top4">
      <h3 class="ek-com-tit2 c6 f3">本月业绩<span class="c5 f1 f-right c-p">累计到 {{time}}</span></h3>
      <div class="  message-box5 mar7-1">
        <ul class="b-radius3 bg4 ">
          <li class=" pad6-1 f2  ">
            <span class="sp1 f3 c5">{{monthDate.sameDayTarget || 0}}</span>
            <span class="f1 c4">新增标保</span>
            <span class=" f1-1 c4 ">(万元)</span>
          </li>
          <li class="b-radius3 pad6-1 f2 mar7-2 bg4">
            <span class="sp1 f3 c5">{{monthDate.sameDayPrem || 0}}</span>
            <span class="f1 c4">新增保费</span>
            <span class=" f1-1 c4 ">(万元)</span>
          </li>
          <li class="b-radius3 pad6-1 f2 mar7-2 bg4">
            <span class="sp1 f3 c5">{{monthDate.policy || 0}}</span>
            <span class="f1 c4">新增保单</span>
            <span class=" f1-1 c4 ">(份)</span>
          </li>
          <li class="b-radius3 pad6-1 f2 mar7-2 bg4">
            <span class="sp1 f3 c5">{{monthDate.extension || 0}}</span>
            <span class="f1 c4">预计佣金</span>
            <span class=" f1-1 c4 ">(元)</span>
          </li>
        </ul>
      </div>
      <div><img src="@/assets/img/index/chart4.png" /></div>
      <div class="more-box2 t-center c-p">更多业绩详情</div>
    </div>
  </div>
</template>

<script>
  import { mapGetters } from 'vuex'
  import * as tool from '@/common/Tool'
  import { api_user } from '@/api/index'

  export default {
    name: "Performance",
    data () {
      return {
        yesterdayDate: {},
        monthDate: {},
        time: ''
      }
    },
    computed: {
      ...mapGetters(['user']),
    },
    props: {
      worksStatus: Number
    },
    created () {
      this.getYesterdayData() // 昨日业绩
      this.getMonthData() // 当月业绩
    },
    mounted () {
      this.getTime()
    },
    methods: {
      getTime () {
        const newDate = new Date(),
          year = newDate.getFullYear(),
          month = newDate.getMonth() + 1,
          day = newDate.getDate()
        this.time = year + '-' + month + '-' + day
      },
      getYesterdayData () {
        const _data = {
          saasId: tool.app.saasId,
          agentCode: '1', // this.user.userInfo && this.user.userInfo.agentCode ? this.user.userInfo.agentCode : '',
          dateFlag: 'D'
        }
        api_user.getSameDayTarget(_data).then(data => {
          if (data.status === tool.rtCode.status) {
            this.yesterdayDate = data
          } else {
            tool.toastMessage(data.message, 'error')
          }
        })
      },
      getMonthData () {
        const _data = {
          saasId: tool.app.saasId,
          agentCode: '1', // this.user.userInfo && this.user.userInfo.agentCode ? this.user.userInfo.agentCode : '',
          dateFlag: 'M'
        }
        api_user.getSameDayTarget(_data).then(data => {
          if (data.status === tool.rtCode.status) {
            this.monthDate = data
          } else {
            tool.toastMessage(data.message, 'error')
          }
        })
      }
    },
    // watch: {
    //   worksStatus () {
    //     if (this.worksStatus === 3) {
          // this.getYesterdayData()
          // this.getMonthData()
    //     }
    //   }
    // }
  }
</script>

<style scoped>

</style>
