<template>
  <div class="bg3">
    <div class="fun-top-panel bg7 ">
      <span
        class="mess-back "
        @click="goBack()"
      >
        <div class="cont"></div>
      </span>
      <span class="title c3 f3 dblock2 t-center ">知识库</span>
    </div>
    <div class="main-top p-fix bg7 b-radius2">
      <section class="f-flex  border-b1">
        <div class="sear-bb ">
          <div class=" new-search ns2 clearfix">
            <section class="sear-c posi2 clearfix">
              <form
                action=""
                class="input-search-form"
                id="search_from"
              >
                <van-search
                  v-model="searchval"
                  shape="round"
                  background=""
                  placeholder="请输入搜索关键词"
                />
              </form>
            </section>
          </div>
        </div>
      </section>
    </div>
    <div class="main-container mar4-5 bg7 bot1 clearfix">
      <section class="tab-box3 ">
        <span
          class=" c-p"
          @click="getBtn(index)"
          :class="tabnum == index?'active':''"
          v-for="(item,index) in tagList" :key="index"
        ></span>
        <span
          class=" c-p"
          @click="getBtn(1)"
          :class="tabnum == 1?'active':''"
        >猜你想问</span>
        <span
          class=" c-p"
          @click="getBtn(2)"
          :class="tabnum == 2?'active':''"
        >开场白</span>
        <span
          class=" c-p"
          @click="getBtn(3)"
          :class="tabnum == 3?'active':''"
        >名词介绍</span>
        <span
          class=" c-p"
          @click="getBtn(4)"
          :class="tabnum == 4?'active':''"
        >保险锦囊</span>
        <span
          class=" c-p"
          @click="getBtn(5)"
          :class="tabnum == 5?'active':''"
        >拒绝话术</span>
        <span
          class=" c-p"
          @click="getBtn(6)"
          :class="tabnum == 6?'active':''"
        >理赔指南</span>
      </section>
      <section>
        <van-collapse
          v-model="activeName"
          accordion
        >
          <van-collapse-item
            v-for="(item,index) in lmKnowledgeList"
            :key="index"
            :title="index+'. '+item.title"
            :name="item.id"
            @click="getKnowledgeClassList('0')"
          >
          {{item.title}}
            <van-collapse
              v-model="chiildName"
              accordion
            >
              <van-collapse-item
                v-for="(item,index) in list"
                :key="index"
                :title="index+'. '+item.className"
                :name="item.id"
                @click="getKnowledgeClassList('0')"
              >
              {{item.className}}
                <van-collapse
                  v-model="chiildwName"
                  accordion
                >
                  <van-collapse-item
                    v-for="(item,index) in list"
                    :key="index"
                    :title="index+'. '+item.className"
                    :name="item.id"
                  >
                    {{item.className}}
                  </van-collapse-item>
                </van-collapse>
              </van-collapse-item>
            </van-collapse>
          </van-collapse-item>
        </van-collapse>
      </section>
    </div>
    <!-- <div class="t-center f3 c6 pad6">未找到答案？<span class="c8">去提问</span></div> -->
  </div>
</template>

<script>
import Vue from 'vue'
import { mapGetters } from 'vuex'
import { api_my } from '@/api/index'
import * as tool from '@/common/Tool'
import { Collapse, CollapseItem, Search } from 'vant';

Vue.use(Collapse);
Vue.use(CollapseItem);
Vue.use(Search);
export default {
  data() {
    return {
      tabnum: 1,
      searchval: '',
      activeName: '1',
      chiildName: '1',
      chiildwName: '1',
      list: [],
      tagList: [],
      lmKnowledgeList: []
    }
  },
  computed: {
    ...mapGetters(['user']),
  },
  created() {
    this.getKnowledgeClassList();
    this.getKnowledgeTitle();
    this.getDefaultLabelList();
  },
  methods: {
    goBack() {
      this.$router.go(-1)
    },
    getBtn(num) {
      this.tabnum = num;
      this.ngetKnowledgeTitle();
    },
    getKnowledgeClassList(val) {
      let _data = {
        "platformId": "f2ce8561055a40d5a5e7dcdffde1e8bc",
        "saasId": "ff5a67337b6611e89feafa163eb3e537",
        "classLevel": 1,
        "parentId": val
      }
      api_my.getKnowledgeClassList(_data).then(res => {
        if (res.status == tool.rtCode.status) {
          this.list = res.knowledgeClassList
        } else {
          tool.toastMessage(res.message, 'error');

        }
      })
    },
    getKnowledgeTitle() {
      let _data = {
        // "platformId": "f2ce8561055a40d5a5e7dcdffde1e8bc",
        "saasId": "ff5a67337b6611e89feafa163eb3e537",
        // "classId":this.tabnum,
        "classId": 7
      }
      api_my.getKnowledgeTitle(_data).then(res => {
        if (res.status == tool.rtCode.status) {
          this.lmKnowledgeList = res.lmKnowledgeList
        } else {
          tool.toastMessage(res.message, 'error');
        }
      })
    },
    getDefaultLabelList() {
      let _data = {
        "saasId": "ff5a67337b6611e89feafa163eb3e537"
      }
      api_my.getDefaultLabelList(_data).then(res => {
        if (res.status == tool.rtCode.status) {
          this.tagList = res.lmKnowledgeDefaultLabelList
        } else {
          tool.toastMessage(res.message, 'error');
        }
      })
    }
  },
}
</script>

<style>
</style>